<!DOCTYPE html>
<html>
    <head>
        <title>Cloud Maze Solver</title>
        <script src="js/scripts.js"></script>
        <link rel="stylesheet" href="css/styles.css">
        <link rel="icon" type="image/x-icon" href="img/favicon.ico">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script src="lib/jquery-3.6.4.min.js"></script>
    </head>
    <body>
        <div id="main">
            
            <img id=img height=40 src="https://lh3.googleusercontent.com/a-/AOh14Gh-CwvGkngFp6REJf46ncZD2p-nesp_4DmKOpSXGA=k-s420"   />
            <canvas id="canvas" width="644" height="644"></canvas>
			<div id="status"></div>
            <div id="colorType"></div>
            <script>
            /*    var key = {
	UP: 38,
	DOWN: 40,
	LEFT: 37,
	RIGHT: 39,
  C: 67
};

window.addEventListener("keydown", function(e) {
    if(["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
        e.preventDefault();
    }
}, false);

console.log(key);

document.addEventListener("keydown", drawAction);
document.addEventListener("keydown", clearCanvas);

var square = document.getElementById("canvas");
var paper = square.getContext("2d");
var x = 314;
var y =3;

drawing_line("#9fd5ff", x-1, y, x, y, paper);








function drawing_line(color, x_start, y_start, x_end, y_end, board){
	board.beginPath();
	board.strokeStyle = color;
	board.lineWidth = 4;
	board.moveTo(x_start,y_start);
	board.lineTo(x_end,y_end);
	board.stroke(); 
	board.closePath();
}

function drawAction(whenPressKey){
	

	


	var colorLine ="#9fd5ff";
	var dotMove = 6;

	switch(whenPressKey.keyCode){

		case key.UP:
			drawing_line(colorLine, x, y, x, y - dotMove, paper);
			y = y - dotMove;
		break;

		case key.DOWN:
			drawing_line(colorLine, x, y, x, y + dotMove, paper);
			y = y + dotMove;
		break;

		case key.LEFT:
			drawing_line(colorLine, x, y, x - dotMove, y, paper);
			x = x - dotMove;
		break;

		case key.RIGHT:
			drawing_line(colorLine, x, y, x + dotMove, y, paper);
			x = x + dotMove;
		break;

		default:
		console.log("Another key");
	}
}

function clearCanvas(whenPressKey) {
	if (whenPressKey.keyCode == key.C) {
		paper.clearRect(0, 0, square.width, square.height);
		x= 314;
		y=3;
        var background = new Image();
                background.src = "img/maze/Maze_00.svg";
        background.onload = function(){
                ctx.drawImage(background,0,0);
        }
	}
}*/
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');
var EL_img = document.querySelector("#img");
var pos = {x:0, y:0};
var colorType = document.getElementById("#colorType");

document.addEventListener("keydown", function(ev) {
  var dir = (ev.key.match(/(?<=^Arrow)\w+/)||[])[0];
  if (!dir) return; // Not an arrow key.
  ev.preventDefault(); // Prevent Browser scroll if overflow

  ({
    Left:  function() {pos.x -= 5;},
    Right: function() {pos.x += 5;},
    Up:    function() {pos.y -= 5;},
    Down:  function() {pos.y += 5;},
  }[dir])(); 

  var imgRect = EL_img.getBoundingClientRect();
  var canvasX = imgRect.left - window.scrollX + pos.x;
  var canvasY = imgRect.top - window.scrollY + pos.y;

  // Check if the image is within the boundaries of the canvas.
  if (canvasX >= 0 && canvasY >= 0 && canvasX < canvas.width && canvasY < canvas.height) {
    var imageData = context.getImageData(canvasX, canvasY, 1, 1);
    var pixel = imageData.data;
    var color = "rgb(" + pixel[0] + ", " + pixel[1] + ", " + pixel[2] + ")";

    colorType.textContent = color;
  }

  EL_img.style.transform = "translate(" + pos.x + "px, " + pos.y + "px)";
});


                canvas = document.getElementById("canvas"),
                ctx = canvas.getContext("2d");

                var background = new Image();
                background.src = "img/maze/Maze_00.svg";
                
                
                // Make sure the image is loaded first otherwise nothing will draw.
                background.onload = function(){
                ctx.drawImage(background,0,0);
				
                   
}
canvas.fillStyle = randomColor();
canvas.fillRect(265, 265, 295, 295);

$('#canvas').mousemove(function(e) {
    var pos = findPos(this);
    var x = e.pageX - pos.x;
    var y = e.pageY - pos.y;
    var coord = "x=" + x + ", y=" + y;
    var c = this.getContext('2d');
    var p = c.getImageData(x, y, 1, 1).data; 
    var hex = "#" + ("000000" + rgbToHex(p[0], p[1], p[2])).slice(-6);
    $('#status').html(coord + "<br>" + hex);
});

function findPos(obj) {
    var curleft = 0, curtop = 0;
    if (obj.offsetParent) {
        do {
            curleft += obj.offsetLeft;
            curtop += obj.offsetTop;
        } while (obj = obj.offsetParent);
        return { x: curleft, y: curtop };
    }
    return undefined;
}

function rgbToHex(r, g, b) {
    if (r > 255 || g > 255 || b > 255)
        throw "Invalid color component";
    return ((r << 16) | (g << 8) | b).toString(16);
}

function randomInt(max) {
  return Math.floor(Math.random() * max);
}

function randomColor() {
    return `rgb(${randomInt(256)}, ${randomInt(256)}, ${randomInt(256)})`
}

            </script>
        </div>
    </body>
</html>